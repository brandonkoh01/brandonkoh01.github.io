<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Justin Bieber Fanpage</title>
    <meta name="description"
        content="A fully-featured Justin Bieber fan page built with vanilla HTML, CSS, and JavaScript." />
    <link rel="icon"
        href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ctext y='50' x='6' font-size='48'%3Eüéµ%3C/text%3E%3C/svg%3E">
    <style>
        :root {
            --bg: #0f1014;
            --bg-elev: #171923;
            --ink: #e7e8ee;
            --muted: #adb0c4;
            --accent: #8ab4ff;
            --accent-2: #ffd580;
            --pink: #ff8dc7;
            --success: #77e0a3;
            --danger: #ff6b6b;
            --shadow: 0 12px 30px rgba(0, 0, 0, .35);
            --radius: 14px;
        }

        * {
            box-sizing: border-box
        }

        html,
        body {
            height: 100%
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';
            background: radial-gradient(1200px 600px at 80% -20%, rgba(138, 180, 255, .18), transparent 60%),
                radial-gradient(900px 500px at 10% -10%, rgba(255, 141, 199, .12), transparent 60%),
                var(--bg);
            color: var(--ink);
            line-height: 1.55;
        }

        /* Global UI */
        a {
            color: var(--accent);
            text-decoration: none
        }

        a:hover {
            text-decoration: underline
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px
        }

        .pill {
            display: inline-flex;
            align-items: center;
            gap: .5rem;
            padding: .4rem .75rem;
            border-radius: 999px;
            border: 1px solid #2a2f45;
            background: #1a1e2c;
            color: var(--ink);
            font-size: .85rem
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: .6rem;
            background: linear-gradient(135deg, #4c74ff, #7e9dff);
            color: white;
            border: none;
            padding: .8rem 1.1rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: .2s transform, .2s box-shadow
        }

        .btn.secondary {
            background: linear-gradient(135deg, #ff8dc7, #ffd580);
            color: #0d0e13
        }

        .btn.ghost {
            background: transparent;
            border: 1px solid #2a2f45;
            box-shadow: none
        }

        .btn:hover {
            transform: translateY(-2px)
        }

        .chip {
            display: inline-flex;
            align-items: center;
            gap: .4rem;
            background: #141724;
            border: 1px solid #2a2f45;
            color: var(--muted);
            padding: .35rem .6rem;
            border-radius: 10px;
            font-size: .8rem
        }

        .section {
            padding: 64px 0
        }

        .grid {
            display: grid;
            gap: 24px
        }

        .shadow {
            box-shadow: var(--shadow)
        }

        .card {
            background: var(--bg-elev);
            border: 1px solid #2a2f45;
            border-radius: var(--radius);
            overflow: hidden
        }

        .sr-only {
            position: absolute !important;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0
        }

        /* Header / Hero */
        header {
            position: sticky;
            top: 0;
            z-index: 50;
            backdrop-filter: saturate(140%) blur(8px);
            background: linear-gradient(180deg, rgba(15, 16, 20, .9), rgba(15, 16, 20, .6));
            border-bottom: 1px solid #24283b;
        }

        nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 0
        }

        nav .left {
            display: flex;
            align-items: center;
            gap: 14px
        }

        .logo {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: conic-gradient(from 120deg, #7e9dff, #ff8dc7, #ffd580, #7e9dff);
            display: grid;
            place-items: center;
            color: #0f1014;
            font-weight: 900;
            box-shadow: var(--shadow)
        }

        .navlinks {
            display: flex;
            gap: 18px;
            align-items: center
        }

        .navlinks a {
            color: var(--muted);
            font-weight: 600
        }

        .navlinks a.active,
        .navlinks a:hover {
            color: var(--ink)
        }

        .theme-toggle {
            background: #161a28;
            border: 1px solid #2a2f45;
            border-radius: 12px;
            padding: .45rem .7rem;
            color: var(--ink);
            cursor: pointer
        }

        .search {
            position: relative;
            display: flex;
            align-items: center;
            gap: 10px;
            background: #121526;
            border: 1px solid #2a2f45;
            border-radius: 12px;
            padding: .5rem .75rem;
            color: var(--muted)
        }

        .search input {
            background: transparent;
            border: none;
            outline: none;
            color: var(--ink);
            width: 220px
        }

        .hero {
            padding: 44px 0 24px;
            display: grid;
            gap: 26px;
            grid-template-columns: 1.2fr .8fr;
            align-items: center
        }

        .hero h1 {
            font-size: clamp(28px, 4.2vw, 54px);
            line-height: 1.05;
            margin: 0
        }

        .sub {
            color: var(--muted);
            font-size: 1.05rem
        }

        .cta-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 14px
        }

        .hero-visual {
            position: relative;
            height: 420px;
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid #2a2f45;
            background: #0b0d14
        }

        .hero-visual img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: .95;
            filter: saturate(1.05) contrast(1.02)
        }

        .floating {
            position: absolute;
            padding: .55rem .75rem;
            border-radius: 12px;
            background: rgba(17, 20, 33, .9);
            border: 1px solid #2a2f45;
            color: var(--ink);
            backdrop-filter: blur(6px);
            box-shadow: var(--shadow);
            font-size: .9rem
        }

        .floating.top {
            top: 14px;
            left: 14px
        }

        .floating.bottom {
            bottom: 14px;
            right: 14px
        }

        /* Audio player */
        .player {
            display: flex;
            align-items: center;
            gap: 14px;
            background: #131729;
            border: 1px solid #2a2f45;
            border-radius: 16px;
            padding: 10px 12px
        }

        .player .cover {
            width: 56px;
            height: 56px;
            border-radius: 12px;
            overflow: hidden
        }

        .player .cover img {
            width: 100%;
            height: 100%;
            object-fit: cover
        }

        .player .meta {
            flex: 1
        }

        .player .meta .title {
            font-weight: 700
        }

        .player .meta .artist {
            color: var(--muted);
            font-size: .9rem
        }

        .player button {
            background: #1b1f31;
            border: 1px solid #2a2f45;
            color: var(--ink);
            border-radius: 10px;
            padding: .5rem .75rem;
            cursor: pointer
        }

        .player input[type="range"] {
            width: 160px
        }

        /* Sections */
        h2 {
            margin: 0 0 18px;
            font-size: clamp(22px, 3vw, 34px)
        }

        .albums {
            grid-template-columns: repeat(12, 1fr)
        }

        .albums .tile {
            grid-column: span 3;
            min-height: 260px;
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid #2a2f45;
            background: #0b0d14
        }

        .albums .tile.large {
            grid-column: span 6
        }

        .albums .tile img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: contrast(1.05) saturate(1.1)
        }

        .albums .tile .label {
            position: absolute;
            left: 10px;
            bottom: 10px;
            background: rgba(0, 0, 0, .55);
            backdrop-filter: blur(4px);
            padding: .4rem .6rem;
            border-radius: 10px;
            font-weight: 700
        }

        .albums .tile .actions {
            position: absolute;
            right: 10px;
            top: 10px;
            display: flex;
            gap: 8px
        }

        .albums .tile .actions button {
            background: rgba(20, 24, 39, .85);
            border: 1px solid #2a2f45;
            color: var(--ink);
            border-radius: 10px;
            padding: .4rem .6rem;
            cursor: pointer
        }

        /* Gallery Carousel */
        .carousel {
            position: relative;
            overflow: hidden;
            border: 1px solid #2a2f45;
            border-radius: 16px
        }

        .track {
            display: flex;
            transition: transform .5s ease
        }

        .slide {
            min-width: 100%;
            height: 440px;
            position: relative
        }

        .slide img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover
        }

        .slide .caption {
            position: absolute;
            left: 14px;
            bottom: 14px;
            background: rgba(0, 0, 0, .55);
            backdrop-filter: blur(4px);
            padding: .45rem .7rem;
            border-radius: 10px
        }

        .carousel .nav {
            position: absolute;
            inset: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            pointer-events: none
        }

        .carousel .nav button {
            pointer-events: auto;
            background: rgba(14, 16, 24, .7);
            border: 1px solid #2a2f45;
            color: var(--ink);
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer
        }

        .dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 10px
        }

        .dots button {
            width: 10px;
            height: 10px;
            border-radius: 999px;
            border: 1px solid #2a2f45;
            background: #1a1e2c;
            cursor: pointer
        }

        .dots button.active {
            background: linear-gradient(135deg, #7e9dff, #ff8dc7)
        }

        /* Timeline */
        .timeline {
            position: relative;
            margin-left: 6px;
            padding-left: 26px;
            border-left: 2px dashed #2b3250
        }

        .milestone {
            position: relative;
            margin: 18px 0;
            padding: 14px;
            background: #111527;
            border: 1px solid #2a2f45;
            border-radius: 12px
        }

        .milestone::before {
            content: "";
            position: absolute;
            left: -34px;
            top: 18px;
            width: 18px;
            height: 18px;
            border-radius: 999px;
            background: linear-gradient(135deg, #7e9dff, #ffd580);
            box-shadow: 0 0 0 4px #0f1014
        }

        .milestone .tag {
            font-weight: 700;
            color: var(--accent)
        }

        .milestone .year {
            float: right;
            color: var(--muted)
        }

        /* Quiz */
        .quiz {
            display: grid;
            gap: 12px
        }

        .quiz .q {
            background: #12162a;
            border: 1px solid #2a2f45;
            border-radius: 12px;
            padding: 14px
        }

        .quiz .choices {
            display: grid;
            gap: 8px;
            margin-top: 8px
        }

        .quiz .choices button {
            background: #1a1f35;
            border: 1px solid #2a2f45;
            color: var(--ink);
            border-radius: 10px;
            padding: .6rem .8rem;
            cursor: pointer;
            text-align: left
        }

        .quiz .choices button.correct {
            background: rgba(119, 224, 163, .12);
            border-color: #3aa56d
        }

        .quiz .choices button.wrong {
            background: rgba(255, 107, 107, .12);
            border-color: #cf5252
        }

        .results {
            margin-top: 10px;
            color: var(--muted)
        }

        /* Comments */
        .comments .item {
            display: grid;
            grid-template-columns: 40px 1fr;
            gap: 12px;
            padding: 10px 0;
            border-bottom: 1px dashed #2a2f45
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 999px;
            background: linear-gradient(135deg, #7e9dff, #ff8dc7)
        }

        .comments .meta {
            display: flex;
            gap: 8px;
            align-items: center
        }

        .comments .meta .name {
            font-weight: 700
        }

        .comments .meta .time {
            color: var(--muted);
            font-size: .85rem
        }

        .comment-form {
            display: grid;
            gap: 10px
        }

        textarea {
            width: 100%;
            min-height: 80px;
            border-radius: 12px;
            border: 1px solid #2a2f45;
            background: #0e1222;
            color: var(--ink);
            padding: .7rem
        }

        /* Footer / Back to top */
        footer {
            padding: 28px 0;
            border-top: 1px solid #24283b;
            color: var(--muted)
        }

        .back-to-top {
            position: fixed;
            right: 18px;
            bottom: 18px;
            z-index: 40
        }

        .hide {
            display: none !important
        }

        /* Responsive */
        @media (max-width:980px) {
            .hero {
                grid-template-columns: 1fr;
                gap: 18px
            }

            .albums .tile {
                grid-column: span 6
            }
        }

        @media (max-width:640px) {
            .navlinks {
                display: none
            }

            .search input {
                width: 120px
            }

            .albums .tile {
                grid-column: span 12
            }

            .hero-visual {
                height: 320px
            }

            .slide {
                height: 340px
            }
        }

        /* Accessibility focus */
        :focus-visible {
            outline: 2px solid var(--accent);
            outline-offset: 2px;
            border-radius: 10px
        }
    </style>
</head>

<body>

    <header>
        <div class="container">
            <nav aria-label="Primary">
                <div class="left">
                    <div class="logo" aria-hidden="true">JB</div>
                    <span class="pill" title="Unofficial fan community">Unofficial Fan Community</span>
                </div>
                <div class="navlinks" role="navigation">
                    <a href="#top" class="active">Home</a>
                    <a href="#albums">Albums</a>
                    <a href="#gallery">Gallery</a>
                    <a href="#timeline">Timeline</a>
                    <a href="#quiz">Quiz</a>
                    <a href="#community">Community</a>
                </div>
                <div style="display:flex;gap:10px;align-items:center">
                    <label class="search" aria-label="Search site">
                        <span aria-hidden="true">üîé</span>
                        <input id="siteSearch" type="search" placeholder="Search sections‚Ä¶" autocomplete="off" />
                    </label>
                    <button class="theme-toggle" id="themeToggle" aria-pressed="false" title="Toggle theme">üåô</button>
                </div>
            </nav>
        </div>
    </header>

    <main id="top" class="container">

        <!-- Hero -->
        <section class="hero section" aria-labelledby="hero-heading">
            <div>
                <span class="chip">Belieber Hub</span>
                <h1 id="hero-heading">Justin Bieber ‚Äî music, moments, and a community that never says never.</h1>
                <p class="sub">Dive into albums, iconic photos, milestones, and a fun trivia quiz. Create a personal
                    playlist, leave messages, and celebrate the journey.</p>
                <div class="cta-row">
                    <button class="btn" id="playAllBtn">‚ñ∂ Play Snippets</button>
                    <button class="btn secondary" id="shuffleBtn">üîÄ Shuffle Gallery</button>
                    <a href="#community" class="btn ghost">üí¨ Join Community</a>
                </div>

                <!-- Mini Audio Player -->
                <div class="player" style="margin-top:16px" aria-label="Audio player">
                    <div class="cover"><img id="cover" src="justin3.jpg" alt="Cover art" /></div>
                    <div class="meta">
                        <div class="title" id="trackTitle">Peaches (snippet)</div>
                        <div class="artist">Justin Bieber</div>
                        <div style="display:flex;gap:10px;align-items:center;margin-top:6px">
                            <input id="seek" type="range" min="0" max="100" value="0" aria-label="Seek" />
                            <span id="time" class="chip">0:00 / 0:00</span>
                        </div>
                    </div>
                    <div style="display:flex;gap:8px;align-items:center">
                        <button id="prevBtn" aria-label="Previous">‚èÆ</button>
                        <button id="playBtn" aria-label="Play/Pause">‚ñ∂</button>
                        <button id="nextBtn" aria-label="Next">‚è≠</button>
                        <label class="chip" title="Volume">
                            üîä
                            <input id="vol" type="range" min="0" max="1" step="0.01" value="0.7" />
                        </label>
                    </div>
                </div>
                <audio id="audio" preload="metadata"></audio>
            </div>

            <div class="hero-visual shadow" aria-hidden="true">
                <img src="justin1.jpg" alt="">
                <div class="floating top">‚ÄúPurpose is found in the journey.‚Äù</div>
                <div class="floating bottom">Latest Era: Timeless</div>
            </div>
        </section>

        <!-- Featured Albums / Tiles -->
        <section id="albums" class="section" aria-labelledby="albums-heading">
            <h2 id="albums-heading">Highlights & Albums</h2>
            <div class="grid albums">
                <article class="tile large shadow">
                    <img src="justin2.jpg" alt="Justin reclining on a bench">
                    <div class="label">Fan Favorite Performances</div>
                    <div class="actions">
                        <button class="save-tile" aria-label="Save tile">üíñ</button>
                        <button class="share-tile" aria-label="Share tile">‚Üó</button>
                    </div>
                </article>

                <article class="tile shadow">
                    <img src="justin3.jpg" alt="Justin in white tee">
                    <div class="label">Purpose</div>
                    <div class="actions"><button class="add-to-playlist" data-title="Sorry (snippet)"
                            data-cover="justin3.jpg">‚ûï Add</button></div>
                </article>

                <article class="tile shadow">
                    <img src="justin4.jpg" alt="Black & white portrait">
                    <div class="label">Justice</div>
                    <div class="actions"><button class="add-to-playlist" data-title="Peaches (snippet)"
                            data-cover="justin4.jpg">‚ûï Add</button></div>
                </article>

                <article class="tile shadow">
                    <img src="justin1.jpg" alt="Young Justin with blue shirt">
                    <div class="label">Believe</div>
                    <div class="actions"><button class="add-to-playlist" data-title="Boyfriend (snippet)"
                            data-cover="justin1.jpg">‚ûï Add</button></div>
                </article>

                <article class="tile shadow">
                    <img src="justin2.jpg" alt="Relaxed Justin on bench">
                    <div class="label">Changes</div>
                    <div class="actions"><button class="add-to-playlist" data-title="Intentions (snippet)"
                            data-cover="justin2.jpg">‚ûï Add</button></div>
                </article>
            </div>
        </section>

        <!-- Gallery Carousel -->
        <section id="gallery" class="section" aria-labelledby="gallery-heading">
            <h2 id="gallery-heading">Photo Gallery</h2>
            <div class="carousel shadow" aria-roledescription="carousel" aria-label="Justin gallery">
                <div class="track" id="track">
                    <figure class="slide"><img src="justin1.jpg" alt="Young Justin looking at camera">
                        <figcaption class="caption">Early days</figcaption>
                    </figure>
                    <figure class="slide"><img src="justin2.jpg" alt="Justin reclined on bench">
                        <figcaption class="caption">Chill vibes</figcaption>
                    </figure>
                    <figure class="slide"><img src="justin3.jpg" alt="Justin in white tee posing">
                        <figcaption class="caption">Purpose era</figcaption>
                    </figure>
                    <figure class="slide"><img src="justin4.jpg" alt="Black and white thoughtful portrait">
                        <figcaption class="caption">Studio focus</figcaption>
                    </figure>
                </div>
                <div class="nav">
                    <button id="prevSlide" aria-label="Previous slide">‚ùÆ</button>
                    <button id="nextSlide" aria-label="Next slide">‚ùØ</button>
                </div>
            </div>
            <div class="dots" id="dots" aria-label="Carousel pagination"></div>
            <div style="display:flex;gap:10px;align-items:center;margin-top:10px">
                <button class="btn ghost" id="autoPlayToggle">‚è∏ Pause Autoplay</button>
                <span class="chip">Tip: swipe on touch devices</span>
            </div>
        </section>

        <!-- Timeline -->
        <section id="timeline" class="section" aria-labelledby="timeline-heading">
            <h2 id="timeline-heading">Milestones Timeline</h2>
            <div class="timeline" id="timelineList">
                <!-- Injected via JS -->
            </div>
        </section>

        <!-- Quiz -->
        <section id="quiz" class="section" aria-labelledby="quiz-heading">
            <h2 id="quiz-heading">Belieber Trivia</h2>
            <div class="quiz" id="quizBox">
                <!-- Questions injected by JS -->
            </div>
            <div class="results" id="quizResults" aria-live="polite"></div>
            <div style="display:flex;gap:10px;margin-top:8px">
                <button class="btn" id="restartQuiz">üîÅ Restart Quiz</button>
                <label class="chip"><input id="quizTimed" type="checkbox" /> Timed mode</label>
                <span id="timer" class="chip hide">‚è± 30s</span>
            </div>
        </section>

        <!-- Community -->
        <section id="community" class="section" aria-labelledby="community-heading">
            <h2 id="community-heading">Community Wall</h2>
            <form class="comment-form card" id="commentForm" style="padding:14px">
                <div style="display:grid;gap:10px;grid-template-columns:1fr 1fr">
                    <label>Nickname
                        <input id="nickname" type="text" placeholder="Belieber123" required
                            style="width:100%;padding:.6rem;border-radius:10px;border:1px solid #2a2f45;background:#0e1222;color:var(--ink)">
                    </label>
                    <label>Favorite era
                        <select id="era"
                            style="width:100%;padding:.6rem;border-radius:10px;border:1px solid #2a2f45;background:#0e1222;color:var(--ink)">
                            <option>Believe</option>
                            <option>Purpose</option>
                            <option>Changes</option>
                            <option selected>Justice</option>
                            <option>Timeless</option>
                        </select>
                    </label>
                </div>
                <label>Message
                    <textarea id="message" placeholder="Share a memory, lyric, or how the music helped you‚Ä¶"
                        required></textarea>
                </label>
                <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
                    <button class="btn" type="submit">Post Message</button>
                    <button class="btn ghost" id="clearWall" type="button">Clear Wall</button>
                    <label class="chip"><input id="anon" type="checkbox" /> Post anonymously</label>
                </div>
            </form>

            <div class="card" style="margin-top:14px">
                <div
                    style="display:flex;justify-content:space-between;align-items:center;padding:12px 14px;border-bottom:1px solid #2a2f45">
                    <div style="display:flex;gap:8px;align-items:center">
                        <span class="chip">Newest</span>
                        <span class="chip">Top</span>
                    </div>
                    <div style="display:flex;gap:8px">
                        <button class="btn ghost" id="exportWall" title="Export messages as JSON">‚¨á Export</button>
                        <label class="btn ghost" title="Import JSON">
                            ‚¨Ü Import
                            <input id="importWall" type="file" accept="application/json" class="sr-only">
                        </label>
                    </div>
                </div>
                <div id="comments" class="comments" style="padding:10px 14px" aria-live="polite">
                    <!-- Comments injected here -->
                </div>
            </div>
        </section>

    </main>

    <footer>
        <div class="container"
            style="display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap">
            <div>Made with ‚ù§Ô∏è by fans. This is an unofficial fan page.</div>
            <div style="display:flex;gap:10px;align-items:center">
                <span class="chip">#Belieber</span>
                <span class="chip">#Purpose</span>
                <span class="chip">#Justice</span>
            </div>
        </div>
    </footer>

    <button class="btn back-to-top hide" id="backToTop" aria-label="Back to top">‚¨Ü</button>

    <script>
        /* Utility helpers */
        const $ = (sel, root = document) => root.querySelector(sel);
        const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

        /* Theme toggle with persistence */
        const themeToggle = $('#themeToggle');
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const savedTheme = localStorage.getItem('theme');
        setTheme(savedTheme || (prefersDark ? 'dark' : 'dark')); // default dark for style

        function setTheme(mode) {
            document.documentElement.dataset.theme = mode;
            themeToggle.textContent = mode === 'dark' ? 'üåô' : '‚òÄÔ∏è';
            themeToggle.setAttribute('aria-pressed', mode === 'dark' ? 'true' : 'false');
            // Optional: adjust CSS variables for light mode
            if (mode === 'light') {
                document.documentElement.style.setProperty('--bg', '#f7f7fb');
                document.documentElement.style.setProperty('--bg-elev', '#ffffff');
                document.documentElement.style.setProperty('--ink', '#0b0d14');
                document.documentElement.style.setProperty('--muted', '#5d6072');
            } else {
                document.documentElement.style.removeProperty('--bg');
                document.documentElement.style.removeProperty('--bg-elev');
                document.documentElement.style.removeProperty('--ink');
                document.documentElement.style.removeProperty('--muted');
            }
        }
        themeToggle.addEventListener('click', () => {
            const next = (document.documentElement.dataset.theme === 'dark') ? 'light' : 'dark';
            localStorage.setItem('theme', next);
            setTheme(next);
        });

        /* Search: quick jump to sections */
        const index = [
            { k: 'home, hero, top', id: '#top' },
            { k: 'albums, songs, discography, highlights', id: '#albums' },
            { k: 'gallery, photos, images, pictures', id: '#gallery' },
            { k: 'timeline, milestones, awards, career', id: '#timeline' },
            { k: 'quiz, trivia', id: '#quiz' },
            { k: 'community, comments, wall', id: '#community' }
        ];
        $('#siteSearch').addEventListener('keydown', e => {
            if (e.key === 'Enter') {
                e.preventDefault();
                const q = e.target.value.trim().toLowerCase();
                const hit = index.find(x => x.k.includes(q.split(' ')[0]));
                if (hit) { location.hash = hit.id; e.target.blur(); }
            }
        });

        /* Smooth scroll for internal links */
        $$('a[href^="#"]').forEach(a => {
            a.addEventListener('click', e => {
                const href = a.getAttribute('href');
                if (href.length > 1) {
                    e.preventDefault();
                    document.querySelector(href)?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    history.pushState(null, '', href);
                }
            });
        });

        /* Back to top visibility */
        const backToTop = $('#backToTop');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 400) backToTop.classList.remove('hide');
            else backToTop.classList.add('hide');
        });
        backToTop.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

        /* Audio player with snippet playlist (royalty-free beeps generated via Oscillator) */
        const audio = $('#audio');
        const playBtn = $('#playBtn');
        const nextBtn = $('#nextBtn');
        const prevBtn = $('#prevBtn');
        const seek = $('#seek');
        const time = $('#time');
        const vol = $('#vol');
        const cover = $('#cover');
        const trackTitle = $('#trackTitle');
        const playAllBtn = $('#playAllBtn');

        let context, sourceNode;
        let playlist = [
            { title: 'Peaches (snippet)', cover: 'justin4.jpg', tone: 392 },
            { title: 'Sorry (snippet)', cover: 'justin3.jpg', tone: 440 },
            { title: 'Boyfriend (snippet)', cover: 'justin1.jpg', tone: 349 },
            { title: 'Intentions (snippet)', cover: 'justin2.jpg', tone: 523 }
        ];
        const storedList = localStorage.getItem('jb-playlist');
        if (storedList) {
            try { const parsed = JSON.parse(storedList); if (Array.isArray(parsed) && parsed.length) playlist = parsed; } catch { }
        }
        let i = 0; let playing = false; let startTime = 0; let duration = 23; // seconds for generated snippets

        function updateMeta() {
            const t = playlist[i] || playlist[0];
            trackTitle.textContent = t.title;
            cover.src = t.cover;
            time.textContent = '0:00 / ' + fmt(duration);
            seek.value = 0;
        }
        updateMeta();

        function fmt(s) { s = Math.max(0, Math.floor(s)); const m = Math.floor(s / 60); const r = s % 60; return `${m}:${String(r).padStart(2, '0')}` }

        function ensureContext() {
            if (!context) {
                context = new (window.AudioContext || window.webkitAudioContext)();
            }
        }
        function startTone(freq) {
            ensureContext();
            stopTone();
            sourceNode = context.createOscillator();
            const gain = context.createGain();
            sourceNode.type = 'triangle';
            sourceNode.frequency.value = freq;
            gain.gain.value = 0.08;
            sourceNode.connect(gain).connect(context.destination);
            sourceNode.start();
            startTime = context.currentTime;
            playing = true;
            playBtn.textContent = '‚è∏';
        }
        function stopTone() {
            if (sourceNode) {
                try { sourceNode.stop() } catch { }
                sourceNode.disconnect();
                sourceNode = null;
            }
            playing = false;
            playBtn.textContent = '‚ñ∂';
        }
        function playCurrent() {
            const t = playlist[i];
            startTone(t.tone || 440);
        }
        function next() { i = (i + 1) % playlist.length; updateMeta(); playCurrent(); }
        function prev() { i = (i - 1 + playlist.length) % playlist.length; updateMeta(); playCurrent(); }

        playBtn.addEventListener('click', () => playing ? stopTone() : playCurrent());
        nextBtn.addEventListener('click', next);
        prevBtn.addEventListener('click', prev);

        vol.addEventListener('input', () => {
            // For synth, scale master volume via destination gain is nontrivial without a graph; keep as cosmetic indicator
            vol.title = `Volume: ${Math.round(vol.value * 100)}%`;
        });

        seek.addEventListener('input', () => {
            // For synth demo, we simulate seeking by restarting tone and offsetting "startTime"
            if (!context) return;
            const pct = seek.value / 100;
            const offset = duration * pct;
            if (sourceNode) {
                startTone(playlist[i].tone);
                startTime = context.currentTime - offset;
            }
        });

        setInterval(() => {
            if (!context || !playing) return;
            const elapsed = context.currentTime - startTime;
            if (elapsed >= duration) { next(); return; }
            const pct = Math.min(100, Math.floor(elapsed / duration * 100));
            seek.value = pct;
            time.textContent = `${fmt(elapsed)} / ${fmt(duration)}`;
        }, 200);

        $('#shuffleBtn').addEventListener('click', () => {
            // Shuffle gallery slides order and dots
            const order = $$('#track .slide');
            for (let k = order.length - 1; k > 0; k--) {
                const j = Math.floor(Math.random() * (k + 1));
                const a = order[k]; const b = order[j];
                a.parentNode.insertBefore(a, b);
            }
            // Fun pulse
            $('#gallery-heading').animate([{ transform: 'scale(1)' }, { transform: 'scale(1.06)' }, { transform: 'scale(1)' }], { duration: 400 });
        });

        playAllBtn.addEventListener('click', () => { i = 0; updateMeta(); playCurrent(); });

        /* Add-to-playlist buttons from tiles */
        $$('.add-to-playlist').forEach(btn => {
            btn.addEventListener('click', () => {
                const title = btn.dataset.title;
                const cover = btn.dataset.cover;
                const tone = 300 + Math.floor(Math.random() * 300);
                playlist.push({ title, cover, tone });
                localStorage.setItem('jb-playlist', JSON.stringify(playlist));
                btn.textContent = '‚úî Added';
                btn.disabled = true;
                setTimeout(() => { btn.textContent = '‚ûï Add'; btn.disabled = false; }, 1200);
            });
        });

        /* Save / share tile actions */
        $$('.save-tile').forEach(b => {
            b.addEventListener('click', () => {
                b.textContent = 'üíñ Saved';
                b.closest('.tile').animate([{ filter: 'brightness(1)' }, { filter: 'brightness(1.2)' }, { filter: 'brightness(1)' }], { duration: 500 });
            });
        });
        $$('.share-tile').forEach(b => {
            b.addEventListener('click', async () => {
                const shareData = { title: 'Justin Bieber Highlights', text: 'Check out this awesome fan highlight!', url: location.href };
                try {
                    if (navigator.share) { await navigator.share(shareData); }
                    else { await navigator.clipboard.writeText(shareData.url); alert('Link copied!'); }
                } catch { }
            });
        });

        /* Carousel */
        const track = $('#track');
        const slides = $$('.slide', track);
        const dots = $('#dots');
        let idx = 0; let autoplay = true; let autoTimer;

        function renderDots() {
            dots.innerHTML = '';
            slides.forEach((_, i) => {
                const d = document.createElement('button');
                d.setAttribute('aria-label', 'Go to slide ' + (i + 1));
                if (i === idx) d.classList.add('active');
                d.addEventListener('click', () => go(i, true));
                dots.appendChild(d);
            });
        }
        function go(n, user) {
            idx = (n + slides.length) % slides.length;
            track.style.transform = `translateX(-${idx * 100}%)`;
            renderDots();
            if (user) { pauseAuto(); }
        }
        $('#prevSlide').addEventListener('click', () => go(idx - 1, true));
        $('#nextSlide').addEventListener('click', () => go(idx + 1, true));

        function startAuto() { clearInterval(autoTimer); autoplay = true; autoTimer = setInterval(() => go(idx + 1, false), 3500); $('#autoPlayToggle').textContent = '‚è∏ Pause Autoplay'; }
        function pauseAuto() { clearInterval(autoTimer); autoplay = false; $('#autoPlayToggle').textContent = '‚ñ∂ Resume Autoplay'; }
        $('#autoPlayToggle').addEventListener('click', () => autoplay ? pauseAuto() : startAuto());
        renderDots(); startAuto();

        /* Swipe support */
        let sx = 0; let dx = 0;
        track.addEventListener('touchstart', e => { sx = e.touches[0].clientX; });
        track.addEventListener('touchmove', e => { dx = e.touches.clientX - sx; });
        track.addEventListener('touchend', () => { if (Math.abs(dx) > 40) { go(idx + (dx < 0 ? 1 : -1), true); } dx = 0; });

        /* Timeline data and rendering */
        const milestones = [
            { year: '2009', tag: 'Debut', text: 'Breakout with early singles and viral rise from online covers.', img: 'justin1.jpg' },
            { year: '2012', tag: 'Believe era', text: 'Pop dominance and global tours cementing superstardom.', img: 'justin1.jpg' },
            { year: '2015', tag: 'Purpose', text: 'Massive hits and new sound shaping modern pop.', img: 'justin3.jpg' },
            { year: '2020', tag: 'Changes', text: 'R&B-influenced direction and intimate songwriting.', img: 'justin2.jpg' },
            { year: '2021', tag: 'Justice', text: 'Chart-topping singles and collaborations worldwide.', img: 'justin4.jpg' },
            { year: '2024', tag: 'New chapters', text: 'Studio sessions and features keep momentum strong.', img: 'justin4.jpg' }
        ];
        const timelineList = $('#timelineList');
        milestones.forEach(m => {
            const el = document.createElement('article');
            el.className = 'milestone';
            el.innerHTML = `
    <div class="year">${m.year}</div>
    <div class="tag">${m.tag}</div>
    <p style="margin:.35rem 0 .5rem">${m.text}</p>
    <img src="${m.img}" alt="" style="width:100%;max-height:180px;object-fit:cover;border-radius:10px;border:1px solid #2a2f45">
  `;
            timelineList.appendChild(el);
        });

        /* Quiz logic */
        const quizData = [
            { q: 'Complete the phrase: Never _____.', choices: ['Give In', 'Say Never', 'Stop', 'Let Go'], a: 1 },
            { q: 'Which vibe best describes the Purpose era?', choices: ['Rock', 'EDM-pop', 'Country', 'Classical'], a: 1 },
            { q: 'Pick the fruit from a hit title:', choices: ['Peaches', 'Bananas', 'Cherries', 'Apples'], a: 0 },
            { q: 'Which of these is a collab-heavy era?', choices: ['Justice', 'Baroque', 'Indie Folk', 'Grunge'], a: 0 },
            { q: 'A love-forward 2020 album?', choices: ['Changes', 'Mirrors', 'Echoes', 'Skylines'], a: 0 }
        ];
        let score = 0; let answered = 0; let timed = false; let remaining = 30; let tInt;

        const quizBox = $('#quizBox');
        function renderQuiz() {
            quizBox.innerHTML = '';
            quizData.forEach((item, qi) => {
                const q = document.createElement('div'); q.className = 'q';
                q.innerHTML = `<div><strong>Q${qi + 1}.</strong> ${item.q}</div>`;
                const choices = document.createElement('div'); choices.className = 'choices';
                item.choices.forEach((c, ci) => {
                    const btn = document.createElement('button');
                    btn.textContent = c;
                    btn.addEventListener('click', () => {
                        if (btn.classList.contains('correct') || btn.classList.contains('wrong')) return;
                        answered++;
                        if (ci === item.a) { score++; btn.classList.add('correct'); }
                        else { btn.classList.add('wrong'); choices.children[item.a].classList.add('correct'); }
                        updateResults();
                    });
                    choices.appendChild(btn);
                });
                q.appendChild(choices);
                quizBox.appendChild(q);
            });
            score = 0; answered = 0; updateResults();
        }
        renderQuiz();

        function updateResults() {
            $('#quizResults').textContent = `Score: ${score}/${quizData.length} ‚Ä¢ Answered: ${answered}/${quizData.length}${timed ? ' ‚Ä¢ Time left: ' + remaining + 's' : ''}`;
        }

        $('#restartQuiz').addEventListener('click', () => {
            if (timed) { clearInterval(tInt); remaining = 30; }
            renderQuiz();
        });

        const quizTimed = $('#quizTimed');
        const timer = $('#timer');
        quizTimed.addEventListener('change', () => {
            timed = quizTimed.checked;
            timer.classList.toggle('hide', !timed);
            remaining = 30;
            clearInterval(tInt);
            if (timed) {
                tInt = setInterval(() => {
                    remaining--;
                    timer.textContent = '‚è± ' + remaining + 's';
                    updateResults();
                    if (remaining <= 0) {
                        clearInterval(tInt);
                        // Disable all buttons
                        $$('.quiz .choices button').forEach(b => b.disabled = true);
                        $('#quizResults').textContent += ' ‚Ä¢ Time up!';
                    }
                }, 1000);
            }
        });

        /* Community comments with localStorage */
        const commentsEl = $('#comments');
        const commentForm = $('#commentForm');
        const STORAGE_KEY = 'jb-wall';

        function loadComments() {
            commentsEl.innerHTML = '';
            const list = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            list.forEach(addCommentDOM);
        }
        function addCommentDOM(item) {
            const el = document.createElement('div');
            el.className = 'item';
            el.innerHTML = `
    <div class="avatar" aria-hidden="true"></div>
    <div>
      <div class="meta">
        <span class="name">${item.name}</span>
        <span class="time">‚Ä¢ ${new Date(item.time).toLocaleString()}</span>
        <span class="chip">${item.era}</span>
        <button class="btn ghost" style="padding:.2rem .5rem" title="Like">üíñ <span>${item.likes || 0}</span></button>
        <button class="btn ghost" style="padding:.2rem .5rem" title="Delete">üóë</button>
      </div>
      <p style="margin:.4rem 0 0">${item.msg}</p>
    </div>`;
            const [likeBtn, delBtn] = el.querySelectorAll('button');
            likeBtn.addEventListener('click', () => {
                item.likes = (item.likes || 0) + 1;
                likeBtn.querySelector('span').textContent = item.likes;
                persist(item);
            });
            delBtn.addEventListener('click', () => {
                if (confirm('Delete this message?')) removeItem(item);
            });
            commentsEl.prepend(el);
        }
        function persist(item) {
            const list = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            const idx = list.findIndex(x => x.id === item.id);
            if (idx > -1) list[idx] = item; else list.push(item);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
        }
        function removeItem(item) {
            let list = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            list = list.filter(x => x.id !== item.id);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(list));
            loadComments();
        }

        commentForm.addEventListener('submit', e => {
            e.preventDefault();
            const name = $('#anon').checked ? 'Anonymous Belieber' : ($('#nickname').value.trim() || 'Fan');
            const era = $('#era').value;
            const msg = $('#message').value.trim();
            if (!msg) return;
            const item = { id: crypto.randomUUID(), name, era, msg, time: Date.now(), likes: 0 };
            persist(item); addCommentDOM(item);
            commentForm.reset();
        });

        $('#clearWall').addEventListener('click', () => {
            if (confirm('Clear all messages?')) { localStorage.removeItem(STORAGE_KEY); loadComments(); }
        });

        $('#exportWall').addEventListener('click', () => {
            const blob = new Blob([localStorage.getItem(STORAGE_KEY) || '[]'], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href = url; a.download = 'jb-community.json'; a.click();
            URL.revokeObjectURL(url);
        });
        $('#importWall').addEventListener('change', async e => {
            const file = e.target.files[0]; if (!file) return;
            const text = await file.text();
            try {
                const data = JSON.parse(text);
                if (Array.isArray(data)) { localStorage.setItem(STORAGE_KEY, JSON.stringify(data)); loadComments(); }
                else alert('Invalid file.');
            } catch { alert('Invalid JSON.'); }
            e.target.value = '';
        });

        loadComments();

        /* Intersection animations */
        const io = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.animate([{ opacity: 0, transform: 'translateY(12px)' }, { opacity: 1, transform: 'translateY(0)' }], { duration: 500, easing: 'ease-out' });
                    io.unobserve(entry.target);
                }
            });
        }, { threshold: .1 });
        $$('.section').forEach(s => io.observe(s));
    </script>

</body>

</html>